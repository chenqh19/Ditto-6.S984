# thrift

We use cog to automatically generate C++ source files for each microservice. The template input for cog is implemented in template_grpc.cpp and is called in src_files_gen.py. You can find how to use cog at [here](https://nedbatchelder.com/code/cog/).

In src_files_gen.py, we also format generated C++ files with clang-format and generate CMakeLists files for building and deploying use.

thrift_gen.py is used to generate thrift files (both C++ and lua) needed by thrift communications. These files will be included in the source code of each microservice.

lua_rewrite.py is used to reformat some lua scripts generated by thrift because these scripts will be included in the Nginx to transfer the http requests from client(wrk2) to rpc call. 

docker-compose_gen.py is used to generate docker-compose file for further deployment with docker compose.

auto.py is a wrapper script to invoke above scripts. You can set up the path to the configuration file that describe the topology of the application and this config would be needed by the other scripts. The "path" argument for auto.py defines which topology (in config/paths.json) to generate, you can refer the [README](https://github.com/Mingyu-Liang/topology_generator/blob/main/config/README.md) to find the description of these configuration files.
